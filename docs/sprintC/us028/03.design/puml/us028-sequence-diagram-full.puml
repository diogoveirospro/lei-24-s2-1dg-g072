@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

autonumber

'hide footbox
actor "Collaborator" as Col
participant ":ListTaskSpaceUI" as UI
participant ":ListTaskController" as CTRL
participant ":Repositories" as RepositorySingleton
participant "repositories\n:Repositories" as REP
participant "collaboratorRepository\n:CollaboratorRepository" as collaboratorRepository
participant "date:Date" as Date
participant "taskRepository\n:TaskRepository" as taskRepository
participant ":TaskMapper" as Mapper
participant "taskList\n:List<Task>" as LISTTASK
participant "statusList\n:List<String>" as LISTSTATUS
participant "taskListDto\n:List<TaskDto>" as LISTTASKDTO
participant "taskDto\n:TaskDto" as DTO

activate Col

           Col -> UI : requests to consult tasks assigned to him

           activate UI

                UI -> CTRL** : create
                UI -> CTRL: getCollaboratorThoughEmail(email)
                activate CTRL

                        CTRL -> RepositorySingleton: getInstance()
                        activate RepositorySingleton

                                RepositorySingleton --> CTRL: repositories
                        deactivate RepositorySingleton

                        CTRL -> REP: getCollaboratorRepository
                        activate REP

                                REP --> CTRL: collaboratorRepository
                        deactivate REP

                        CTRL -> collaboratorRepository: getCollaboratorThoughEmail(email)
                        activate collaboratorRepository

                                collaboratorRepository -> collaboratorRepository: getCollaboratorThoughEmail(email)
                                activate collaboratorRepository

                                        collaboratorRepository --> CTRL: collaborator
                                deactivate collaboratorRepository

                        deactivate collaboratorRepository
                        CTRL --> UI: collaborator
                deactivate CTRL
               UI --> Col : asks to select the beginning and end date of the search
           deactivate UI

           Col -> UI : selects the beginning and end date
           activate UI

                    UI -> CTRL: saveDatesSelected(dateI,dateF)
                    activate CTRL
                            loop For both dates selected
                            CTRL -> Date**: Date(date)
                            end
                            CTRL --> UI: true/false statement
                    deactivate CTRL

                    UI -> CTRL: getStatusList()
                    activate CTRL

                            CTRL -> RepositorySingleton: getInstance()
                            activate RepositorySingleton

                                    RepositorySingleton --> CTRL: repositories
                            deactivate RepositorySingleton

                            CTRL -> REP: getTaskRepository()
                            activate REP

                                    REP --> CTRL: taskRepository
                            deactivate REP

                            CTRL -> taskRepository: getStatusList()

                            activate taskRepository


                                                        taskRepository --> LISTSTATUS** : create()


                                                            loop for each status in the system
                                                                taskRepository -> LISTSTATUS : add(status)
                                                                activate LISTSTATUS

                                                            end

                                                            LISTSTATUS --> taskRepository : statusList
                                                        deactivate LISTSTATUS



                                    taskRepository --> CTRL: statusList
                            deactivate taskRepository


                            CTRL --> UI: statusList
                    deactivate CTRL
                   UI --> Col: asks to select the type of status he wants to consult
           deactivate UI

           Col -> UI : Selects the type he wants to consult
        activate UI

            UI --> Col : asks for confirmation
        deactivate UI
            Col -> UI : confirms that he wants to create the list
        activate UI



            UI -> CTRL : getTaskList(collaborator,dateI,dateF,typeStatus)
            activate CTRL

                CTRL -> RepositorySingleton : getInstance()
                activate RepositorySingleton

                    RepositorySingleton --> CTRL: repositories
                deactivate RepositorySingleton

                CTRL -> REP : getTaskRepository()
                activate REP

                    REP --> CTRL: taskRepository
                deactivate REP

                CTRL -> taskRepository : getTaskList(collaborator,dateI,dateF,typeStatus)

                activate taskRepository

                        taskRepository -> LISTTASK**: create()

                        loop for each task in the system
                        opt ((typeStatus() == task.getStatus()) && (collaborator.getIdNumber() == task.getIdNumber())\n &&(dateI <= task.getDateI()) && (dateF >= task.getDateF()))

                            taskRepository -> LISTTASK: addTaskOfCollaborator(task)
                            activate LISTTASK





                        end

                        end

                            LISTTASK --> taskRepository: taskList

                            deactivate LISTTASK

                        taskRepository --> CTRL : taskList

                deactivate taskRepository

                deactivate taskRepository

            CTRL -> Mapper : toDTO(taskList)
            activate Mapper

                    Mapper --> LISTTASKDTO** : create()

                                                                loop for each task in taskList
                                                                    Mapper -> LISTTASK : task = get(i)
                                                                    activate LISTTASK

                                                                            LISTTASK --> Mapper : task
                                                                    deactivate LISTTASK

                                                                    Mapper -> DTO** : taskDto = toDTOtask(task)



                                                                    activate DTO


                                                                        DTO --> Mapper : taskDto


                                                                    deactivate DTO
                                                                    Mapper -> LISTTASKDTO : add(taskDto)
                                                                    activate LISTTASKDTO

                                                                            end
                                                                            LISTTASKDTO --> Mapper : taskListDto
                                                                    deactivate LISTTASKDTO



                                                                Mapper --> CTRL : taskListDto


            deactivate Mapper
            CTRL --> UI: taskListDto
            deactivate CTRL
            UI --> Col: shows the LISTTASK
    deactivate UI

deactivate Col



@enduml