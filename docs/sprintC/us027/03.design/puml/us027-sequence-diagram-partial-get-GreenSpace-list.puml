@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

autonumber

'hide footbox

participant ":ListGreenSpaceController" as CTRL
participant ":Repositories" as RepositorySingleton
participant "repositories\n:Repositories" as REP
participant "greenSpaceRepository\n:GreenSpaceRepository" as greenSpaceRepository
participant "greenSpaceList\n:List<GreenSpace>" as greenSpaceList
participant "em\n:ExternalModule" as EM
participant "refValue\n:RefValue" as RefValue
participant "externalModuleAdapter\n:ExternalModuleAdapter" as Adapter
participant ":GreenSpaceMapper" as Mapper

autonumber 11

 -> CTRL : getGreenSpaceList(greenSpaceManager,sortingOption)
autonumber 11.1
activate CTRL
    group Get GreenSpace List




                CTRL -> RepositorySingleton : getInstance()
                activate RepositorySingleton

                    RepositorySingleton --> CTRL: repositories
                deactivate RepositorySingleton

                CTRL -> REP : getGreenSpaceRepository()
                activate REP

                    REP --> CTRL: greenSpaceRepository
                deactivate REP

                CTRL -> greenSpaceRepository : getGreenSpaceList(greenSpaceManager,sortingOption)

                activate greenSpaceRepository

                        greenSpaceRepository -> greenSpaceList**: create()
                                                loop for each greenSpace
                        opt greenSpace.getGSM() == greenSpaceManager
                                                    greenSpaceRepository -> greenSpaceList : add(greenSpace)
                                                        activate greenSpaceList





                                                                end

                                                                end


                                                                        greenSpaceList --> greenSpaceRepository: greenSpaceList


                                                        deactivate greenSpaceList


                                                            greenSpaceRepository -> greenSpaceRepository : getExternalModule()

                                                            activate greenSpaceRepository

                                                                greenSpaceRepository --> EM : getReferenceValue(sortingOption)
                                                                activate EM

                                                                        EM -> RefValue** : create(sortingOption)
                                                                EM --> greenSpaceRepository : refValue
                                                                deactivate EM

                                                                greenSpaceRepository --> Adapter : sortList(refValue,greenSpaceList)
                                                                activate Adapter

                                                                        Adapter -> Adapter : sortList(refValue,greenSpaceList)
                                                                        activate Adapter

                                                                            Adapter --> greenSpaceRepository : greenSpaceList
                                                                        deactivate Adapter

                                                                deactivate Adapter

                        greenSpaceRepository --> CTRL : greenSpaceList


                deactivate greenSpaceRepository

    deactivate greenSpaceRepository


    end
    autonumber 12
    CTRL -> Mapper : toDto(greenSpaceList)
        activate Mapper


@enduml